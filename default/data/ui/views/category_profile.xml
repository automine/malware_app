<form>
  <label>Category Profile</label>
  <fieldset submitButton="true">
    <input type="time" token="field1">
      <label></label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="text" token="category">
      <label>Category</label>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Detections of items categorized as $category$ over time</title>
      <chart>
        <search>
          <query>| `malware_tstats_prestats` count from datamodel=Malware.Malware_Attacks where Malware_Attacks.category="$category$" by _time span=30m | `drop_malware_dm` | timechart count</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top Signatures in Category $category$</title>
      <table>
        <search>
          <query>| `malware_tstats` count from datamodel=Malware.Malware_Attacks where Malware_Attacks.category="$category$" by Malware_Attacks.signature | `drop_malware_dm` | sort 20 - count</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">/app/malware_app/malware_search?form.category=$category$&amp;form.signature=$row.signature$&amp;form.field1.earliest=$earliest$&amp;form.field1.latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Top File Names Detected as $category$</title>
      <table>
        <search>
          <query>| `malware_tstats` count from datamodel=Malware.Malware_Attacks where Malware_Attacks.category="$category$" by Malware_Attacks.file_name | `drop_malware_dm` | sort 20 - count</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">/app/malware_app/malware_search?form.category=$category$&amp;form.file_name=$row.file_name$&amp;form.field1.earliest=$earliest$&amp;form.field1.latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Top Destinations with $category$ Detections</title>
      <table>
        <search>
          <query>| `malware_tstats` count from datamodel=Malware.Malware_Attacks where Malware_Attacks.category="$category$" by Malware_Attacks.dest | `drop_malware_dm` | sort 20 - count</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">/app/malware_app/malware_search?form.category=$category$&amp;form.dest=$row.dest$&amp;form.field1.earliest=$earliest$&amp;form.field1.latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Summary of the latest 100 detection events categorized as $category$</title>
      <table>
        <search>
          <query>| `malware_tstats` count from datamodel=Malware.Malware_Attacks where Malware_Attacks.category="$category$" by _time Malware_Attacks.dest Malware_Attacks.signature  Malware_Attacks.category  Malware_Attacks.file_path  Malware_Attacks.file_name | `drop_malware_dm` | sort 100 - _time</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">/app/malware_app/malware_search?form.dest=$row.dest$&amp;form.signature=$row.signature$&amp;form.category=$row.category$&amp;form.file_name=$row.file_name$&amp;form.field1.earliest=$earliest$&amp;form.field1.latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
</form>