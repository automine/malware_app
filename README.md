# Malware App for Splunk

## Overview
This app provides dashboards and reports based on events from anti-malware systems. To do this, the app relies on the Splunk Common Information Model (CIM) for malware detection events. This means that the app can report on any malware/av data, as long as it has been on-boarded properly, and is available through the [Malware data model](http://docs.splunk.com/Documentation/CIM/latest/User/Malware).

## A note on Splunk Data Model Acceleration and Disk Space
This app requires data model acceleration, which will use additional disk space. If you are using the Splunk App for Enterprise Security, this is already enabled, and should have been factored into your retention policies. If not, you should review the documentation on [data model acceleration, how it uses disk space, and how to plan for it](http://docs.splunk.com/Documentation/Splunk/latest/Knowledge/Acceleratedatamodels#Data_model_summary_size_on_disk).

## A note on the Splunk Common Information Model
As mentioned above, the app uses the CIM for malware detection events. The CIM allows you to take events from a number of sources or products, and report on them in one cohesive manner, using a common set of names for fields and event types.

## Available Dashboards

### Overview
Provides a starting point for exploring your malware detection events. Most panels will drill-down to other pages in the application.

### Signature Profile
Panels around a particular signature detected. Note that there is no normalization for the values of this field, so this will be dependent on the naming used by the vendor for the individual anti-malware products.

### Destination Profile
Panels around a malware detected on a particular destination. The `destination` field in the `Malware` data model is the system on which the malware has been detected. This dashboard also contains a panel which shows malware operations (such as signatures being updated).

### Category Profile
Panels with reports on category of malware. As with signature names, category names are not normalized across vendors. 

### File Name Profile
Reports on individual file names.

### Malware Search (Advanced)
A form for finding events based on various field values.

### Sourcetypes (Advanced)
Information about the sourcetypes which are present in the accelerated data.

## Prerequisites

### Splunk Versions
This app has been tested with Splunk versions 6.6. This app should be installed on the same search head on which the Malware data model has been accelerated.

### Splunk Common Information Model Add-on
This app depends on data models included in the Splunk Common Information Model Add-on, specifically the `Malware` data model. Please review the information on [installing and using the Splunk Common Information Model Add-on](http://docs.splunk.com/Documentation/CIM/latest/User/Install) and information on [configuring the acceleration on the data model](http://docs.splunk.com/Documentation/Splunk/latest/Knowledge/Acceleratedatamodels#Enable_persistent_acceleration_for_a_data_model).

The Splunk Common Information Model Add-on can be downloaded from [Splunkbase](https://apps.splunk.com/app/1621/).

This app has been tested with versions 4.8 of the CIM add-on. 

### Data model Acceleration on the Malware data model
In order to make the app respond and load quickly, accelerated data models are used to provide summary data. For this data to be available, the `Malware` data model must be accelerated. Information on how to enable acceleration for the `Malware` data model can be found [here](http://docs.splunk.com/Documentation/Splunk/latest/Knowledge/Managedatamodels#Enable_data_model_acceleration). The data model must be accelerated for the length of time for which you would like to see reporting.

## Installation
This app should be installed on a search head where the `Malware` data model has been accelerated. More information on installing or upgrading Splunk apps can be found [here](http://docs.splunk.com/Documentation/Splunk/latest/Admin/Wheretogetmoreapps).

### Simple Installation Process
1. Make sure the field extractions and tags on your malware events are correct.
2. Install the Splunk Common Information Model Add-on (skip if you are installing on an ES search head).
4. Install the Malware App for Splunk.
5. Enable accelerations on the `Malware` data model (skip if you are installing on an ES search head).
6. Wait for the accelerations to start. After the acceleration searches have run, you should start seeing the dashboards populate.

## About support for this app
Support for this app is provided on a best-effort basis. We have released this app for free, and want to help solve issues, and add features, but we also have day-jobs. The Github repo to report issues can be found [here](https://github.com/automine/malware_app).

Need help? Use the Splunk community resources! I can be found on many of them:

* [Splunk Answers](https://answers.splunk.com/)
* [#splunk on Efnet IRC](https://wiki.splunk.com/Community:IRC)
* [Splunk Slack channel](http://splunk402.com/chat/)

## References

### Splunk Common Information Model
* [Splunk Common Information Model Add-on Docs](http://docs.splunk.com/Documentation/CIM/latest/User/Overview)
* [Splunk Common Information Model add-on Malware data model](http://http://docs.splunk.com/documentation/cim/latest/user/Malware)

### Downloads
* Splunk Common Information Model Add-on Download: <https://apps.splunk.com/app/1621/>

## Credits
This app was created by David Shpritz of [Aplura, LLC.](http://www.aplura.com/)

## Release history

### v1.0
Initial release

